<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BilanMetagora - Bilan Simulation Vente</title>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-pixels">
            <div class="pixel"></div>
            <div class="pixel"></div>
            <div class="pixel"></div>
            <div class="pixel"></div>
            <div class="pixel"></div>
            <div class="pixel"></div>
            <div class="pixel"></div>
            <div class="pixel"></div>
        </div>

        <div class="loading-logo">
            <div class="loading-logo-icon">BM</div>
            <span class="loading-logo-text">BilanMetagora</span>
        </div>

        <div class="loading-terminal">
            <div class="terminal-header">
                <div class="terminal-dot red"></div>
                <div class="terminal-dot yellow"></div>
                <div class="terminal-dot green"></div>
            </div>
            <div class="terminal-content" id="terminalContent">
                <div class="terminal-line" id="termLine0">
                    <span class="terminal-prompt">&gt;</span>
                    <span>Initialisation syst√®me...</span>
                    <span class="terminal-status">EN COURS</span>
                </div>
            </div>
            
            <!-- Language, Voice & Scenario Selection -->
            <div class="i18n-selectors" id="i18nSelectors" style="display: none;">
                <div class="selector-row">
                    <span class="selector-label">Sc√©nario</span>
                    <div class="selector-input">
                        <select id="scenarioSelect" class="cyber-select">
                            <option value="individuel">Individuel</option>
                            <option value="equipe">√âquipe</option>
                        </select>
                    </div>
                </div>
                <div class="selector-row">
                    <span class="selector-label">Langue</span>
                    <div class="selector-input">
                        <select id="languageSelect" class="cyber-select"></select>
                    </div>
                </div>
                <div class="selector-row">
                    <span class="selector-label">Voix</span>
                    <div class="selector-input">
                        <select id="voiceSelect" class="cyber-select"></select>
                        <button id="previewVoiceBtn" class="preview-btn" title="Aper√ßu">‚ñ∂</button>
                    </div>
                </div>
                <button id="startExperienceBtn" class="start-btn">D√©marrer l'exp√©rience</button>
            </div>
            
            <div class="loading-progress">
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressBarFill"></div>
                </div>
                <div class="progress-text" id="progressText">Pr√©paration de l'exp√©rience...</div>
            </div>
        </div>
    </div>

    <!-- Background grid -->
    <div class="bg-grid"></div>

    <div class="app-container">
        <!-- Header -->
        <header class="header-bar">
            <div class="logo">
                <div class="logo-icon">BM</div>
                <span class="logo-text">BilanMetagora</span>
            </div>
            <div class="company-badge">METAGORA</div>
        </header>

        <!-- Main layout -->
        <main class="main-layout">
            <!-- Dialogue zone (TOP) -->
            <div class="dialogue-zone">
                <div class="dialogue-box">
                    <div class="dialogue-text" id="dialogueText"></div>
                    <div class="choices-container" id="choicesContainer"></div>
                </div>
                <div class="click-hint" id="clickHint">Cliquez pour continuer...</div>
            </div>

            <!-- Slides container (MIDDLE) -->
            <div class="slides-container">
                <!-- Slide 0: Welcome with rank -->
                <div class="slide active" data-slide="0" data-slide-type="rank">
                    <div class="slide-content">
                        <div class="score-big fade-in">
                            <div class="hexagon-container">
                                <svg viewBox="0 0 100 115">
                                    <polygon points="50 0, 100 28.75, 100 86.25, 50 115, 0 86.25, 0 28.75"/>
                                </svg>
                                <span class="hex-letter">B</span>
                            </div>
                            <div class="rank-info">
                                <span class="rank-title">Rang B</span>
                                <span class="rank-subtitle">Rookie Vendeur</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 1: Stats boxes -->
                <div class="slide" data-slide="1" data-slide-type="stats">
                    <div class="slide-content">
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-value color-b">24</div>
                                <div class="stat-label">Simulations</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value color-a">18</div>
                                <div class="stat-label">Ventes r√©ussies</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value color-b">12</div>
                                <div class="stat-label">Jours actifs</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value color-a">78</div>
                                <div class="stat-label">Score √©coute active</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 2: Resilience (individuel only) -->
                <div class="slide" data-slide="2" data-slide-type="resilience">
                    <div class="slide-content">
                        <div class="resilience-compact">
                            <div class="res-ring-row">
                                <div class="res-ring-wrapper">
                                    <svg class="res-ring" viewBox="0 0 120 120">
                                        <defs>
                                            <linearGradient id="resGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                <stop offset="0%" stop-color="#FF1493" />
                                                <stop offset="100%" stop-color="#FF69B4" />
                                            </linearGradient>
                                        </defs>
                                        <circle class="res-ring-bg" cx="60" cy="60" r="52" />
                                        <circle class="res-ring-fill" id="resRingFill" cx="60" cy="60" r="52" />
                                    </svg>
                                    <div class="res-ring-label">
                                        <span class="res-ring-value" id="resRingValue">78</span>
                                        <span class="res-ring-unit">/100</span>
                                    </div>
                                </div>
                                <div class="res-meta">
                                    <span class="res-meta-title">R√©silience</span>
                                    <span class="res-meta-level" id="resLevel">Level 4/5</span>
                                    <div class="res-mini-stats">
                                        <span class="res-mini-stat"><strong id="resSim">24</strong> sims</span>
                                        <span class="res-mini-stat"><strong id="resProg" class="color-a">+12</strong> pts/mois</span>
                                    </div>
                                </div>
                            </div>
                            <div class="res-sparkline-row">
                                <div class="res-spark" id="resSparkline"></div>
                                <div class="res-spark-labels">
                                    <span id="resSparkStart">66</span>
                                    <span id="resSparkEnd">78</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 3: Emotional Intelligence (individuel only) -->
                <div class="slide" data-slide="3" data-slide-type="emotional">
                    <div class="slide-content">
                        <div class="emotional-card">
                            <div class="emotional-header">
                                <span class="emotional-emoji">üß†</span>
                                <div class="emotional-title-block">
                                    <span class="emotional-title">Intelligence √âmotionnelle</span>
                                    <span class="emotional-subtitle">Empathie & Objections</span>
                                </div>
                            </div>
                            <!-- Panel 1: Scores overview -->
                            <div class="emo-panel" id="emoPanelScores">
                                <div class="emotional-scores">
                                    <div class="emotional-score-item">
                                        <span class="emotional-phase-label">Pr√©sentation</span>
                                        <div class="emotional-bar-container">
                                            <div class="emotional-bar-fill presentation-bar" id="emoPresentationBar"></div>
                                        </div>
                                        <span class="emotional-score-value" id="emoPresentationScore">82%</span>
                                    </div>
                                    <div class="emotional-score-item">
                                        <span class="emotional-phase-label">Objections</span>
                                        <div class="emotional-bar-container">
                                            <div class="emotional-bar-fill objections-bar" id="emoObjectionsBar"></div>
                                        </div>
                                        <span class="emotional-score-value" id="emoObjectionsScore">78%</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Panel 2: Card (front then flip) -->
                            <div class="emo-panel hidden" id="emoPanelCard">
                                <div class="flip-card" id="flipCard0" data-card-index="0">
                                    <div class="flip-card-inner">
                                        <div class="flip-card-front">
                                            <div class="flip-card-badge" id="flipBadge0"></div>
                                            <div class="flip-card-context" id="flipContext0"></div>
                                            <div class="flip-card-response" id="flipResponse0"></div>
                                            <div class="flip-card-diagnostic" id="flipDiagnostic0"></div>
                                        </div>
                                        <div class="flip-card-back">
                                            <div class="flip-card-badge ideal">‚úÖ R√âPONSE ID√âALE</div>
                                            <div class="flip-card-ideal" id="flipIdeal0"></div>
                                            <div class="flip-card-justification" id="flipJustification0"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Panel 3: Actions after flip -->
                            <div class="emotional-actions hidden" id="emotionalActions">
                                <button class="choice-btn" id="emotionalMoreBtn">Plus d'exemples d'erreurs</button>
                                <button class="choice-btn" id="emotionalContinueBtn">Continuer le bilan</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 4: Radar chart -->
                <div class="slide" data-slide="4" data-slide-type="radar">
                    <div class="slide-content">
                        <div class="chart-mini">
                            <canvas id="radarChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Slide 5: Final choices -->
                <div class="slide" data-slide="5" data-slide-type="final">
                    <div class="slide-content">
                        <div class="score-big">
                            <div class="hexagon-container">
                                <svg viewBox="0 0 100 115">
                                    <polygon points="50 0, 100 28.75, 100 86.25, 50 115, 0 86.25, 0 28.75"/>
                                </svg>
                                <span class="hex-letter">B</span>
                            </div>
                            <span class="score-value">82</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Avatar zone (BOTTOM) -->
            <div class="avatar-zone">
                <div class="avatar-container" id="avatarContainer">
                    <img id="avatarImgBack" alt="Avatar Background" style="display: none;">
                    <img id="avatarImg" alt="Avatar" style="display: none;">
                    <div class="avatar-placeholder" id="avatarPlaceholder">Avatar<br>M√©t√©o</div>
                </div>
            </div>
        </main>

        <!-- Progress dots -->
        <div class="progress-dots" id="progressDots">
            <div class="dot active" data-dot="0"></div>
            <div class="dot" data-dot="1"></div>
            <div class="dot" data-dot="2"></div>
            <div class="dot" data-dot="3"></div>
            <div class="dot" data-dot="4"></div>
            <div class="dot" data-dot="5"></div>
        </div>


        <!-- Loading indicator -->
        <div class="loading-indicator" id="loadingIndicator">
            <div class="loading-spinner"></div>
            <span>Chargement...</span>
        </div>
    </div>

    <!-- Scripts (order matters) -->
    <script src="js/data.js"></script>
    <script src="js/i18n-config.js"></script>
    <script src="js/translation-service.js"></script>
    <script src="js/audio-cache.js"></script>
    <script src="js/avatar-controller.js"></script>
    <script src="js/chart.js"></script>
    <script src="js/narrative-controller.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
